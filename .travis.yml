cache:
  pip: true
  timeout: 1000

language: python

matrix:
  fast_finish: true
  include:
    - python: 3.7
      dist: xenial
      after_success:
        - poetry run codecov
    - python: 3.8
      dist: xenial

notifications:
  email: false

# repo branches to test
branches:
  - master
  - develop
  - testing
    - /\d+\.\d+\.\d+/

before_install:
  - pip install poetry

install:
  - poetry install

script:
  - poetry run pytest

deploy:
  provider: pypi
  user: "__token__"
  password:
    secure: "x5LU/gdm2iIBQQUoSpy6MJ6WSZlakM2Mz+fJZWmAfuGRezne2VXlC28s8qILkSmiAL8bCf6FqZUtInsXwxbDACriaP8fjeuFqaY4auD0Xm2dPjOaqCQE+QP+lT5NYRgPd8aC8IAoXdCn5keXrSJn5hdzfB5fxBAMvfTDS2cFrMtP/YjekhY+CqCVU86sauDIh7jlMULeNf+rotUB/auTENIYX65bK+MIDcfnEgb5uKnId6sTGHNPYcFMWwSopZ5NMNhlRFt1pdC5E58bcOReMCG0/+1o3eRSX1BQKiztDPQvDex3HbstuKBOsjlhhyEj7KK42FT7sKp01KGdzozlpte63prZg/WCrRIzJq0D6glcJSJ/yTfwm4V06BwHWtiWx/I84uwaa7mFtcRoha3a8gVpYFiH1yrORPcp0dRvBUy/geC56K4i8ReKl2qRfjEU3oMwYL9XxOlQObs6yBiG01eXpIzq7mxHxbmkU9pPg59p71rC7vKg4r3qb53LeXXLpuxM0J5TynFyWQHZ9cuJdtcI9YZcSsuMVlpaVs2CUsXYSUcQ3DJBAa5YfWz7Hf7TPzvZhWIkZi5LelsjUL55WoOkVZpQAt6E9iKLUxenFk3BoJXk3k6Z762B3TqqjJSv50dId0qbBw7upyb9Z6HRJ2zCZ+lN8G9+NmSJYi/mEns="
  on:
    tags: true
  distributions: "sdist bdist_wheel"
  skip_existing: true
